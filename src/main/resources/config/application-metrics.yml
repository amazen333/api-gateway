management:
  metrics:
    enable:
      gateway.filter: true  # Enable filter metrics
      gateway.route: true   # Enable route metrics
      gateway.request: true # Enable request metrics
    
    distribution:
      percentiles-histogram:
        gateway.filter.seconds: true  # Enable percentiles for filters
      sla:
        gateway.filter.seconds: 10ms,50ms,100ms,500ms,1s  # SLA buckets
    
    tags:
      # Global tags
      application: ${spring.application.name}
      environment: ${ENVIRONMENT:development}
      
      # Gateway-specific tags
      gateway:
        filter: true    # Tag by filter name
        route: true     # Tag by route ID
        path: true      # Tag by request path
        method: true    # Tag by HTTP method
        status: true    # Tag by response status
        outcome: true   # SUCCESS/CLIENT_ERROR/SERVER_ERROR/UNKNOWN
        exception: true # Exception class name (if any)

spring:
  cloud:
    gateway:
      metrics:
        enabled: true
        tags:
          # Enable all tags for detailed analysis
          filter: true
          route: true
          path: true
          method: true
          status: true
          outcome: true
          exception: true
          service: true   # Tag by target service
          instance: true  # Tag by instance ID
          
        # Filter metrics configuration
        filter:
          enabled: true
          name-prefix: "gateway.filter"  # Custom prefix
          percentiles: 0.5,0.95,0.99     # Percentiles to track